### Monitoring Model In SageMaker

The Monitoring pipeline supports monitoring models hosted in SageMaker. For more information on how the pipeline works, check the [Monitoring pipeline](.guide/monitoring-pipeline/introduction.md) section.

Before running the Monitoring pipeline, we'll generate some traffic for the hosted model. You can do that by running the following command:

```shell
uv run -- python pipelines/traffic.py \
    --environment conda run \
    --endpoint endpoint.Sagemaker
```

You can also run the pipeline using `just` along with the `sagemaker-traffic` recipe:

```shell
just sagemaker-traffic
```

It will take a few minutes for SageMaker to store the captured data in the location specified when you deployed the model. After that, you can run the following command to generate fake ground truth labels for the captured data:

```shell
python3 pipelines/endpoint.py --environment=pypi run \
    --action labeling \
    --target sagemaker \
    --target-uri s3://$BUCKET/datastore \
    --ground-truth-uri s3://$BUCKET/ground-truth
```

The `--target-uri` parameter should point to the location where SageMaker stores the data captured from the endpoint. The `--ground-truth-uri` parameter should point to the S3 location where you want to store the generated labels.

Set up Metaflow's built-in viewer for the Monitoring pipeline by running the command below and navigating in your browser toÂ [localhost:8324](http://localhost:8324/):

```shell
python3 pipelines/monitoring.py --environment=pypi card server
```

Finally, run the Monitoring pipeline using the command below. Replace the location of the captured data and the ground truth labels with the values you specified before:

```shell
python3 pipelines/monitoring.py --environment=pypi run \
    --datastore-uri s3://$BUCKET/datastore \
    --ground-truth-uri s3://$BUCKET/ground-truth
```

You will see every report generated by the pipeline in the built-in viewer opened in your browser.